<?
MIOLO::Import('modules::administracao::controls::linkturma');
class frmTurmaNew extends Form
{
	protected $turma;
	function __construct()
	{
		global $MIOLO, $page, $item;
		$this->turma  = $MIOLO->GetBusiness('administracao','turma');
		parent::__construct('Incluir Novo Turma');
		$this->SetClose($MIOLO->GetActionURL(administracao,'main'));
		$this->SetIcon($MIOLO->GetUI()->GetImage('administracao','area_mini.png'));	}
	function CreateFields()
	{
		$fields=array(
			new MTextField('descricao','','Descricao','25'),
		);
		$this->SetFields($fields);
		$buttons=array(
new FormButton('btnCreate','Criar'),
		);
		$this->SetButtons($buttons);
		$this->defaultButton = false;
		$this->SetButtonAttr('btnNew','visible',false);
		$validators = array();
		$this->EventHandler();
	}
	function btnCreate_click()
	{
		global $MIOLO,$page,$module;
		$data=$this->GetData();
		$turma=$MIOLO->GetBusiness($module,'turma');
		$turma->SetData($data);
		try
		{
			$turma->save();
			$go=$MIOLO->GetActionURL('administracao','main:turma',$turma->idturma);
			$page->Redirect($go);
		}
		catch (Exception $e)
		{
			$this->AddError($e->GetMessage());
		}
	}
}
?>
